<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Relat√≥rios Armazenados</title>
  <link rel="stylesheet" href="styles.css"> <!-- Pode usar o mesmo CSS de detalhes -->
  <style>
    .relatorio-mes {
      margin-bottom: 20px;
    }
    .relatorio-data {
      margin-left: 20px;
      cursor: pointer;
      color: blue;
      text-decoration: underline;
    }
    .detalhes-container {
      margin: 10px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 6px 8px;
      text-align: left;
    }
  </style>
</head>
<body class="detalhes-page">
  <header>
    <div class="header-container">
      <div class="logo-container">
        <img src="https://github.com/PereiraP98/controle-materiais-web/blob/main/assets/Logo2.png?raw=true" 
             alt="DevCore Logo" class="logo" />
      </div>
      <h1>Relat√≥rios Armazenados</h1>
      <div class="header-buttons">
        <!-- Bot√£o de Voltar -->
        <button onclick="window.location.href='detalhes.html'">Voltar</button>
      </div>
    </div>
  </header>

  <main class="main-container">
    <section class="detalhes-container">
      <h2>Pastas por M√™s</h2>
      <div id="listaRelatorios"></div>
    </section>
  </main>

  <footer>
    ¬© 2024 COLLAB - Todos os direitos reservados.
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const stored = localStorage.getItem('relatoriosMes');
      if (!stored) {
        document.getElementById('listaRelatorios').innerHTML = 
          '<p>Nenhum relat√≥rio encontrado.</p>';
        return;
      }

      const relatoriosMes = JSON.parse(stored);

      let html = '';
      for (let mes in relatoriosMes) {
        html += `<div class="relatorio-mes">
                   <h3>üìÅ ${mes}</h3>`;
        const datasObjeto = relatoriosMes[mes];
        for (let dataCurta in datasObjeto) {
          html += `<div class="relatorio-data" data-mes="${mes}" data-data="${dataCurta}">
                     üìÑ ${dataCurta}
                   </div>
                   <div id="container-${mes}-${dataCurta}" style="display:none;"></div>`;
        }
        html += `</div>`;
      }

      document.getElementById('listaRelatorios').innerHTML = html;

      const dataElements = document.querySelectorAll('.relatorio-data');
      dataElements.forEach(elem => {
        elem.addEventListener('click', () => {
          const mes = elem.getAttribute('data-mes');
          const dataCurta = elem.getAttribute('data-data');
          const containerId = `container-${mes}-${dataCurta}`;
          const items = relatoriosMes[mes][dataCurta].items;

          const containerDiv = document.getElementById(containerId);
          if (containerDiv.style.display === 'none') {
            let tableHtml = `
              <table>
                <thead>
                  <tr>
                    <th>LOCAL</th>
                    <th>ITEM</th>
                    <th>QTD</th>
                    <th>DESTINO</th>
                    <th>DATA</th>
                    <th>HORA</th>
                    <th>REPORTADO</th>
                  </tr>
                </thead>
                <tbody>
            `;
            items.forEach(item => {
              tableHtml += `
                <tr>
                  <td>${item.local}</td>
                  <td>${item.item}</td>
                  <td>${item.qtd}</td>
                  <td>${item.destino}</td>
                  <td>${item.data}</td>
                  <td>${item.hora}</td>
                  <td>${item.reportado}</td>
                </tr>
              `;
            });
            tableHtml += `</tbody></table>`;
            containerDiv.innerHTML = tableHtml;
            containerDiv.style.display = 'block';
          } else {
            containerDiv.style.display = 'none';
          }
        });
      });
    });
  </script>
</body>
</html>
