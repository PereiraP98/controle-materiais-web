<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatórios de Materiais</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-color: #f4f4f9;
            color: #333;
        }

        .container {
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: #007bff;
            margin-bottom: 20px;
        }

        .folder {
            display: inline-block;
            text-align: center;
            margin: 10px;
            cursor: pointer;
        }

        .folder span {
            display: block;
            margin-top: 5px;
            font-weight: bold;
        }

        .folder-icon {
            font-size: 48px;
            color: #007bff;
        }

        .files {
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            background: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .files table {
            width: 100%;
            border-collapse: collapse;
        }

        .files th, .files td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        .files th {
            background-color: #007bff;
            color: white;
            font-weight: bold;
        }

        .files tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Relatórios de Materiais</h1>

        <div class="folders">
            <!-- Pastas geradas dinamicamente -->
        </div>

        <div id="files" class="files hidden">
            <h2>Relatórios</h2>
            <table>
                <thead>
                    <tr>
                        <th>LOCAL</th>
                        <th>ITEM</th>
                        <th>QTD</th>
                        <th>DESTINO</th>
                        <th>DATA</th>
                        <th>HORA</th>
                        <th>RECEBER</th>
                        <th>TEMPO</th>
                    </tr>
                </thead>
                <tbody id="solicitados"></tbody>
            </table>

            <h2>Materiais Recebidos</h2>
            <table>
                <thead>
                    <tr>
                        <th>LOCAL</th>
                        <th>ITEM</th>
                        <th>QTD</th>
                        <th>DESTINO</th>
                        <th>DATA</th>
                        <th>HORA</th>
                        <th>RECEBIDO</th>
                        <th>TEMPO</th>
                        <th>GUARDADO</th>
                    </tr>
                </thead>
                <tbody id="recebidos"></tbody>
            </table>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const foldersContainer = document.querySelector('.folders');
            const filesContainer = document.getElementById('files');
            const solicitadosTable = document.getElementById('solicitados');
            const recebidosTable = document.getElementById('recebidos');

            // Obter relatórios do localStorage
            const relatorios = JSON.parse(localStorage.getItem('relatorios')) || [];

            // Organizar relatórios por mês
            const relatoriosPorMes = relatorios.reduce((acc, relatorio) => {
                const [ano, mes] = relatorio.data.split('-');
                const key = `${ano}-${mes}`;

                if (!acc[key]) acc[key] = [];
                acc[key].push(relatorio);

                return acc;
            }, {});

            // Criar pastas
            Object.keys(relatoriosPorMes).forEach((mesAno) => {
                const [ano, mes] = mesAno.split('-');
                const folder = document.createElement('div');
                folder.classList.add('folder');
                folder.innerHTML = `<div class="folder-icon">📂</div><span>${mesAno}</span>`;
                foldersContainer.appendChild(folder);

                folder.addEventListener('click', () => {
                    // Mostrar relatórios dentro da pasta
                    const relatóriosMes = relatoriosPorMes[mesAno];

                    solicitadosTable.innerHTML = '';
                    recebidosTable.innerHTML = '';

                    relatóriosMes.forEach((relatorio) => {
                        const solicitadosRows = relatorio.solicitados.map((solicitado) => {
                            const row = document.createElement('tr');
                            solicitado.forEach((cell) => {
                                const td = document.createElement('td');
                                td.textContent = cell;
                                row.appendChild(td);
                            });
                            return row;
                        });

                        const recebidosRows = relatorio.recebidos.map((recebido) => {
                            const row = document.createElement('tr');
                            recebido.forEach((cell) => {
                                const td = document.createElement('td');
                                td.textContent = cell;
                                row.appendChild(td);
                            });
                            return row;
                        });

                        solicitadosRows.forEach((row) => solicitadosTable.appendChild(row));
                        recebidosRows.forEach((row) => recebidosTable.appendChild(row));
                    });

                    filesContainer.classList.remove('hidden');
                });
            });
        });
    </script>
</body>
</html>
